CREATE TABLE project (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   version INTEGER,
   creator_id BIGINT,
   name VARCHAR(255),
   code VARCHAR(255),
   project_nodes JSONB,
   CONSTRAINT pk_project PRIMARY KEY (id)
);

CREATE TABLE project_node_type (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   version INTEGER,
   creator_id BIGINT NULL,
   label VARCHAR(255),
   CONSTRAINT pk_projectnodetype PRIMARY KEY (id)
);

CREATE TABLE role (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   version INTEGER,
   name VARCHAR(255),
   CONSTRAINT pk_role PRIMARY KEY (id)
);

ALTER TABLE project_node_type ADD CONSTRAINT FK_PROJECTNODETYPE_ON_CREATOR FOREIGN KEY (creator_id) REFERENCES users (id);

ALTER TABLE project ADD CONSTRAINT FK_PROJECT_ON_CREATOR FOREIGN KEY (creator_id) REFERENCES users (id);

ALTER TABLE competence ALTER COLUMN appellation TYPE VARCHAR(255) USING (appellation::VARCHAR(255));

ALTER TABLE competence ALTER COLUMN  appellation DROP NOT NULL;

ALTER TABLE domaine ALTER COLUMN appellation TYPE VARCHAR(255) USING (appellation::VARCHAR(255));

ALTER TABLE domaine ALTER COLUMN  appellation DROP NOT NULL;

ALTER TABLE profession ALTER COLUMN appellation TYPE VARCHAR(255) USING (appellation::VARCHAR(255));

ALTER TABLE profession ALTER COLUMN  appellation DROP NOT NULL;

ALTER TABLE profession ALTER COLUMN code_ogr TYPE VARCHAR(255) USING (code_ogr::VARCHAR(255));

ALTER TABLE profession ALTER COLUMN  code_ogr DROP NOT NULL;

ALTER TABLE competence ALTER COLUMN code_rome TYPE VARCHAR(255) USING (code_rome::VARCHAR(255));

ALTER TABLE competence ALTER COLUMN  code_rome DROP NOT NULL;

ALTER TABLE domaine ALTER COLUMN code_rome TYPE VARCHAR(255) USING (code_rome::VARCHAR(255));

ALTER TABLE domaine ALTER COLUMN  code_rome DROP NOT NULL;

ALTER TABLE profession ALTER COLUMN code_rome TYPE VARCHAR(255) USING (code_rome::VARCHAR(255));

ALTER TABLE profession ALTER COLUMN  code_rome DROP NOT NULL;

ALTER TABLE profession ALTER COLUMN  competence_id DROP NOT NULL;

ALTER TABLE users ALTER COLUMN  created_at DROP NOT NULL;

ALTER TABLE competence ALTER COLUMN  domaine_id DROP NOT NULL;

ALTER TABLE users ALTER COLUMN email TYPE VARCHAR(255) USING (email::VARCHAR(255));

ALTER TABLE users ALTER COLUMN  email DROP NOT NULL;

ALTER TABLE users ALTER COLUMN first_name TYPE VARCHAR(255) USING (first_name::VARCHAR(255));

ALTER TABLE users ALTER COLUMN last_name TYPE VARCHAR(255) USING (last_name::VARCHAR(255));

ALTER TABLE users ALTER COLUMN password TYPE VARCHAR(255) USING (password::VARCHAR(255));

ALTER TABLE users ALTER COLUMN  password DROP NOT NULL;

ALTER TABLE users ALTER COLUMN phone TYPE VARCHAR(255) USING (phone::VARCHAR(255));

ALTER TABLE users ALTER COLUMN phone_fixed TYPE VARCHAR(255) USING (phone_fixed::VARCHAR(255));

ALTER TABLE users ALTER COLUMN portfolio_url TYPE VARCHAR(255) USING (portfolio_url::VARCHAR(255));

ALTER TABLE users ALTER COLUMN role TYPE VARCHAR(255) USING (role::VARCHAR(255));

ALTER TABLE seeder ALTER COLUMN  status DROP NOT NULL;

ALTER TABLE seeder ALTER COLUMN table_name TYPE VARCHAR(255) USING (table_name::VARCHAR(255));

ALTER TABLE seeder ALTER COLUMN  table_name DROP NOT NULL;

ALTER TABLE users ALTER COLUMN  updated_at DROP NOT NULL;

ALTER TABLE users ALTER COLUMN user_type TYPE VARCHAR(255) USING (user_type::VARCHAR(255));

ALTER TABLE users ALTER COLUMN  user_type DROP NOT NULL;

ALTER TABLE competence ALTER COLUMN  version DROP NOT NULL;

ALTER TABLE domaine ALTER COLUMN  version DROP NOT NULL;

ALTER TABLE profession ALTER COLUMN  version DROP NOT NULL;

ALTER TABLE seeder ALTER COLUMN  version DROP NOT NULL;

ALTER TABLE users ALTER COLUMN  version DROP NOT NULL;